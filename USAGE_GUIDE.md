# Claude Code 可视化工具 - 使用指南

## 🎉 功能改造完成！

您的Claude Code可视化工具已成功升级，现在可以显示**完整的对话记录**，包括用户问题和Claude的详细回复。

## 🚀 启动方式

```bash
# 方式一：使用启动脚本
python3 start.py

# 方式二：直接启动（需要虚拟环境）
source venv/bin/activate
python app.py
```

访问地址：http://localhost:5000

## ✨ 新功能特性

### 1. 完整对话展示
- ✅ **用户问题** + **Claude回复** 完整显示
- ✅ **消息类型区分**：用户消息（蓝色）、Claude回复（绿色）
- ✅ **时间戳显示**：每条消息的准确时间
- ✅ **内容预览**：长消息自动截断，支持展开查看

### 2. 智能搜索增强
- ✅ **全文搜索**：同时搜索用户问题和Claude回复内容
- ✅ **匹配高亮**：搜索结果中关键词高亮显示
- ✅ **匹配标识**：清楚标识哪些消息包含搜索关键词

### 3. 状态标识
- 🟢 **完整对话**：绿色徽章，表示包含完整对话记录
- 🟡 **仅问题**：黄色徽章，表示只有问题内容

### 4. 增强的操作功能
- 📋 **复制问题**：单独复制用户问题
- 📄 **复制完整对话**：一键复制整个对话记录（格式化输出）
- 🔍 **内容展开**：长消息支持展开/收起
- 👁️ **查看详情**：模态框显示完整对话和调试日志

## 📊 页面功能

### 主页 (/)
- 统计概览：总对话数、项目数、会话数、时间范围
- 最近对话预览：显示最近10条对话的问题和回复预览
- 项目列表：按项目分类显示

### 对话列表 (/conversations)
- 完整对话展示：每个对话显示用户问题和Claude回复
- 分页浏览：每页20条记录
- 快速操作：复制、查看详情、复制完整对话

### 搜索页面 (/search)
- 全文搜索：在用户问题和Claude回复中搜索
- 项目过滤：按项目路径筛选结果
- 匹配高亮：搜索结果中关键词高亮显示

## 🎯 使用场景

### 1. 对话回顾
- 查看之前与Claude的完整对话
- 回顾Claude的建议和解决方案
- 学习和参考之前的交互经验

### 2. 知识管理
- 搜索特定技术问题的解决方案
- 复制有价值的对话内容进行保存
- 按项目整理和查找相关对话

### 3. 工作效率
- 快速找到之前讨论过的代码或方案
- 复制完整对话分享给团队成员
- 跨项目查找类似问题的解决方案

## 🔧 技术实现

### 数据源
- **基础记录**：`~/.claude/history.jsonl` - 用户问题和元数据
- **完整对话**：`~/.claude/projects/{project}/{sessionId}.jsonl` - 完整对话记录
- **调试日志**：`~/.claude/debug/{sessionId}.txt` - 系统调试信息

### 数据处理
- 智能关联基础记录和完整对话文件
- 自动解析不同格式的消息内容
- 支持工具调用和复杂消息结构

### 搜索功能
- 全文搜索：用户问题 + Claude回复
- 大小写不敏感
- 支持中英文搜索
- 结果高亮显示

## 🎊 改造成果

**之前**：只能看到用户发送的问题和系统调试日志
**现在**：可以看到完整的对话记录，包括用户问题和Claude的详细回复

这个工具现在真正成为了一个实用的Claude Code对话管理和查看系统！

## 📝 注意事项

1. **数据完整性**：只有在`~/.claude/projects/`目录下有对应文件的会话才能显示完整对话
2. **性能优化**：大量对话记录可能影响加载速度，建议定期清理旧记录
3. **隐私安全**：对话内容包含您的代码和项目信息，请注意访问权限控制

享受您的全新Claude Code可视化体验！🎉